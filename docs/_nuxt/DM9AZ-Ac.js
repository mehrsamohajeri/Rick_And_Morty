import{Y as N,G as U,Z as v,C as M,$ as I,g as B,a0 as j,B as A,P as O,a1 as H,a2 as q,u as x,a3 as W,a4 as z,a5 as G,q as Y,a6 as Z,a7 as J,a8 as T}from"./BBhg-3u2.js";const Q=15e3,w={timeout:Q,retry:1,retryDelay:1e3};function ia(){const t=N().public.apiBase;return{getCharacters:async(e=1,f)=>{const h=new URLSearchParams;h.set("page",String(e)),f?.trim()&&h.set("name",f.trim());const s=`${t}/character?${h.toString()}`;try{return await $fetch(s,w)}catch(i){if(i&&typeof i=="object"&&"statusCode"in i&&i.statusCode===404)return{info:{count:0,pages:0,next:null,prev:null},results:[]};throw i}},getCharacter:async e=>{try{return await $fetch(`${t}/character/${e}`,w)}catch{return null}},getEpisodes:async e=>{if(e.length===0)return[];try{const f=e.length===1?`${t}/episode/${e[0]}`:`${t}/episode/${e.join(",")}`,h=await $fetch(f,w);return Array.isArray(h)?h:[h]}catch{return[]}},getLocations:async e=>{if(e.length===0)return[];try{const f=e.length===1?`${t}/location/${e[0]}`:`${t}/location/${e.join(",")}`,h=await $fetch(f,w);return Array.isArray(h)?h:[h]}catch{return[]}},extractIdFromUrl:e=>{const f=e.match(/\/(\d+)\/?$/);return f?parseInt(f[1],10):0}}}const X={trailing:!0};function K(a,t=25,c={}){if(c={...X,...c},!Number.isFinite(t))throw new TypeError("Expected `wait` to be a finite number");let o,r,D=[],n,e;const f=(i,g)=>(n=k(a,i,g),n.finally(()=>{if(n=null,c.trailing&&e&&!r){const b=f(i,e);return e=null,b}}),n),h=function(...i){return c.trailing&&(e=i),n||new Promise(g=>{const b=!r&&c.leading;clearTimeout(r),r=setTimeout(()=>{r=null;const l=c.leading?o:f(this,i);e=null;for(const y of D)y(l);D=[]},t),b?(o=f(this,i),g(o)):D.push(g)})},s=i=>{i&&(clearTimeout(i),r=null)};return h.isPending=()=>!!r,h.cancel=()=>{s(r),D=[],e=null},h.flush=()=>{if(s(r),!e||n)return;const i=e;return e=null,f(this,i)},h}async function k(a,t,c){return await a.apply(t,c)}const aa=Symbol.for("nuxt:client-only"),ea=a=>a==="defer"||a===!1;function ca(...a){const t=typeof a[a.length-1]=="string"?a.pop():void 0;ta(a[0],a[1])&&a.unshift(t);let[c,o,r={}]=a,D=!1;const n=B(()=>J(c));if(typeof n.value!="string")throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if(typeof o!="function")throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const e=U();r.server??=!0,r.default??=na,r.getCachedData??=V,r.lazy??=!1,r.immediate??=!0,r.deep??=v.deep,r.dedupe??="cancel",r._functionName,e._asyncData[n.value];function f(){const l={cause:"initial",dedupe:r.dedupe};return e._asyncData[n.value]?._init||(l.cachedData=r.getCachedData(n.value,e,{cause:"initial"}),e._asyncData[n.value]=R(e,n.value,o,r,l.cachedData)),()=>e._asyncData[n.value].execute(l)}const h=f(),s=e._asyncData[n.value];s._deps++;const i=r.server!==!1&&e.payload.serverRendered;{let l=function(d){const u=e._asyncData[d];u?._deps&&(u._deps--,u._deps===0&&u?._off())};const y=Z();if(y&&i&&r.immediate&&!y.sp&&(y.sp=[]),y&&!y._nuxtOnBeforeMountCbs){y._nuxtOnBeforeMountCbs=[];const d=y._nuxtOnBeforeMountCbs;z(()=>{d.forEach(u=>{u()}),d.splice(0,d.length)}),G(()=>d.splice(0,d.length))}const p=y&&(y._nuxtClientOnly||Y(aa,!1));i&&e.isHydrating&&(s.error.value||s.data.value!=null)?(s.pending.value=!1,s.status.value=s.error.value?"error":"success"):y&&(!p&&e.payload.serverRendered&&e.isHydrating||r.lazy)&&r.immediate?y._nuxtOnBeforeMountCbs.push(h):r.immediate&&h();const _=j(),m=M(n,(d,u)=>{if((d||u)&&d!==u){D=!0;const S=e._asyncData[u]?.data.value!==v.value,L=e._asyncDataPromises[u]!==void 0,$={cause:"initial",dedupe:r.dedupe};if(!e._asyncData[d]?._init){let E;u&&S?E=e._asyncData[u].data.value:(E=r.getCachedData(d,e,{cause:"initial"}),$.cachedData=E),e._asyncData[d]=R(e,d,o,r,E)}e._asyncData[d]._deps++,u&&l(u),(r.immediate||S||L)&&e._asyncData[d].execute($),T(()=>{D=!1})}},{flush:"sync"}),C=r.watch?M(r.watch,()=>{D||(e._asyncData[n.value]?._execute.isPending()&&T(()=>{e._asyncData[n.value]?._execute.flush()}),e._asyncData[n.value]?._execute({cause:"watch",dedupe:r.dedupe}))}):()=>{};_&&I(()=>{m(),C(),l(n.value)})}const g={data:P(()=>e._asyncData[n.value]?.data),pending:P(()=>e._asyncData[n.value]?.pending),status:P(()=>e._asyncData[n.value]?.status),error:P(()=>e._asyncData[n.value]?.error),refresh:(...l)=>e._asyncData[n.value]?._init?e._asyncData[n.value].execute(...l):f()(),execute:(...l)=>g.refresh(...l),clear:()=>{const l=e._asyncData[n.value];if(l?._abortController)try{l._abortController.abort(new DOMException("AsyncData aborted by user.","AbortError"))}finally{l._abortController=void 0}F(e,n.value)}},b=Promise.resolve(e._asyncDataPromises[n.value]).then(()=>g);return Object.assign(b,g),b}function P(a){return B({get(){return a()?.value},set(t){const c=a();c&&(c.value=t)}})}function ta(a,t){return!(typeof a=="string"||typeof a=="object"&&a!==null||typeof a=="function"&&typeof t=="function")}function F(a,t){t in a.payload.data&&(a.payload.data[t]=void 0),t in a.payload._errors&&(a.payload._errors[t]=v.errorValue),a._asyncData[t]&&(a._asyncData[t].data.value=void 0,a._asyncData[t].error.value=v.errorValue,a._asyncData[t].pending.value=!1,a._asyncData[t].status.value="idle"),t in a._asyncDataPromises&&(a._asyncDataPromises[t]=void 0)}function ra(a,t){const c={};for(const o of t)c[o]=a[o];return c}function R(a,t,c,o,r){a.payload._errors[t]??=v.errorValue;const D=o.getCachedData!==V,n=c,e=o.deep?A:O,f=r!=null,h=a.hook("app:data:refresh",async i=>{(!i||i.includes(t))&&await s.execute({cause:"refresh:hook"})}),s={data:e(f?r:o.default()),pending:O(!f),error:W(a.payload._errors,t),status:O("idle"),execute:(...i)=>{const[g,b=void 0]=i,l=g&&b===void 0&&typeof g=="object"?g:{};if(a._asyncDataPromises[t]&&ea(l.dedupe??o.dedupe))return a._asyncDataPromises[t];if(l.cause==="initial"||a.isHydrating){const _="cachedData"in l?l.cachedData:o.getCachedData(t,a,{cause:l.cause??"refresh:manual"});if(_!=null)return a.payload.data[t]=s.data.value=_,s.error.value=v.errorValue,s.status.value="success",Promise.resolve(_)}s.pending.value=!0,s._abortController&&s._abortController.abort(new DOMException("AsyncData request cancelled by deduplication","AbortError")),s._abortController=new AbortController,s.status.value="pending";const y=new AbortController,p=new Promise((_,m)=>{try{const C=l.timeout??o.timeout,d=sa([s._abortController?.signal,l?.signal],y.signal,C);if(d.aborted){const u=d.reason;m(u instanceof Error?u:new DOMException(String(u??"Aborted"),"AbortError"));return}return d.addEventListener("abort",()=>{const u=d.reason;m(u instanceof Error?u:new DOMException(String(u??"Aborted"),"AbortError"))},{once:!0,signal:y.signal}),Promise.resolve(n(a,{signal:d})).then(_,m)}catch(C){m(C)}}).then(async _=>{let m=_;o.transform&&(m=await o.transform(_)),o.pick&&(m=ra(m,o.pick)),a.payload.data[t]=m,s.data.value=m,s.error.value=v.errorValue,s.status.value="success"}).catch(_=>{if(a._asyncDataPromises[t]&&a._asyncDataPromises[t]!==p||s._abortController?.signal.aborted)return a._asyncDataPromises[t];if(typeof DOMException<"u"&&_ instanceof DOMException&&_.name==="AbortError")return s.status.value="idle",a._asyncDataPromises[t];s.error.value=q(_),s.data.value=x(o.default()),s.status.value="error"}).finally(()=>{s.pending.value=!1,y.abort(),delete a._asyncDataPromises[t]});return a._asyncDataPromises[t]=p,a._asyncDataPromises[t]},_execute:K((...i)=>s.execute(...i),0,{leading:!0}),_default:o.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{h(),a._asyncData[t]?._init&&(a._asyncData[t]._init=!1),D||H(()=>{a._asyncData[t]?._init||(F(a,t),s.execute=()=>Promise.resolve(),s.data.value=v.value)})}};return s}const na=()=>v.value,V=(a,t,c)=>{if(t.isHydrating)return t.payload.data[a];if(c.cause!=="refresh:manual"&&c.cause!=="refresh:hook")return t.static.data[a]};function sa(a,t,c){const o=a.filter(n=>!!n);if(typeof c=="number"&&c>=0){const n=AbortSignal.timeout?.(c);n&&o.push(n)}if(AbortSignal.any)return AbortSignal.any(o);const r=new AbortController;for(const n of o)if(n.aborted){const e=n.reason??new DOMException("Aborted","AbortError");try{r.abort(e)}catch{r.abort()}return r.signal}const D=()=>{const e=o.find(f=>f.aborted)?.reason??new DOMException("Aborted","AbortError");try{r.abort(e)}catch{r.abort()}};for(const n of o)n.addEventListener?.("abort",D,{once:!0,signal:t});return r.signal}export{ca as a,ia as u};
